{% extends 'base.html' %}
{% block content %}

<h2>Список товаров</h2>

<form method="GET" action="{{ url_for('main_bp.product_list') }}">
    <label>Категория:
        <select name="category">
            <option value="">Все</option>
            {% for category in categories %}
                <option value="{{ category }}" {% if selected_category == category %}selected{% endif %}>{{ category.capitalize() }}</option>
            {% endfor %}
        </select>
    </label>

    <label>Цвет:
        <select name="color">
            <option value="">Все</option>
            {% for color in colors %}
                <option value="{{ color }}" {% if selected_color == color %}selected{% endif %}>{{ color.capitalize() }}</option>
            {% endfor %}
        </select>
    </label>

    <label>Материал:
        <select name="material">
            <option value="">Все</option>
            {% for mat in materials %}
                <option value="{{ mat }}" {% if selected_material == mat %}selected{% endif %}>{{ mat.capitalize() }}</option>
            {% endfor %}
        </select>
    </label>
    

    <label>Цена от:
        <input type="number" step="0.01" name="price_min" value="{{ price_min if price_min else '' }}">
    </label>
    <label>до:
        <input type="number" step="0.01" name="price_max" value="{{ price_max if price_max else '' }}">
    </label>

    <label>Сортировать по:
        <select name="sort_by">
            <option value="">Без сортировки</option>
            <option value="price" {% if sort_by == 'price' %}selected{% endif %}>По цене</option>
            <option value="rating" {% if sort_by == 'rating' %}selected{% endif %}>По рейтингу</option>
            <option value="created" {% if sort_by == 'created' %}selected{% endif %}>По дате добавления</option>
        </select>
    </label>

    <button type="submit" class="btn btn-primary">Применить</button>
    <!-- Кнопка для очистки фильтров -->
    <a href="{{ url_for('main_bp.product_list') }}" class="btn btn-secondary">Очистить фильтры</a>
</form>

{% if products %}
<ul>
  {% for product in products %}
    <li>
      <a href="{{ url_for('main_bp.product_detail', product_id=product.id) }}">
        {{ product.name }} - {{ product.price }} руб. | {{ product.category }} | {{ product.color }} | {{ product.material }} | рейтинг: {{ product.rating }}
      </a>
    </li>
  {% endfor %}
</ul>
{% else %}
<p>Нет товаров, удовлетворяющих критериям.</p>
{% endif %}

{% endblock %}
