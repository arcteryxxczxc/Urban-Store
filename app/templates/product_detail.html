{% extends 'base.html' %}
{% block content %}
<h2>{{ product.name }}</h2>
<p>{{ product.description }}</p>
<p>Цена: {{ product.price }} руб.</p>

<form method="POST" action="{{ url_for('main_bp.add_to_cart', product_id=product.id) }}">
    Количество: <input type="number" name="quantity" value="1" min="1">
    <button type="submit">В корзину</button>
</form>

<form method="POST" action="{{ url_for('main_bp.add_favorite', product_id=product.id) }}">
    <button type="submit">В избранное</button>
</form>

<h3>Отзывы</h3>
<ul>
  {% for review in reviews %}
    <li>Рейтинг: {{ review.rating }} — {{ review.comment }}</li>
  {% endfor %}
</ul>

{% if current_user.is_authenticated %}
<h4>Оставить отзыв</h4>
<form method="POST" action="{{ url_for('main_bp.add_review', product_id=product.id) }}">
    Рейтинг (1-5): <input type="number" name="rating" min="1" max="5" value="5"><br>
    Комментарий: <br>
    <textarea name="comment" rows="4" cols="50"></textarea><br>
    <button type="submit">Отправить</button>
</form>
{% else %}
<p>Чтобы оставить отзыв, войдите в систему.</p>
{% endif %}
{% endblock %}
